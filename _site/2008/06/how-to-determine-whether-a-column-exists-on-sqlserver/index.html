<!DOCTYPE html> 
<html lang="en"> 
    <head> 
        <meta charset="utf-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
        <title>How to determine whether a column exists on SQLServer</title> 
				<meta name="author" content="Ben Emson" />
				<link href="http://feeds.feedburner.com/ben-emson" rel="alternate" title="Ben Emsonr" type="application/atom+xml" />

			   <!-- syntax highlighting CSS -->
			   <link rel="stylesheet" href="/css/syntax.css" type="text/css" />

			   <!-- Homepage CSS -->
			   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
    </head> 
 
    <body>  
        <div id="container"> 
 
            <h1><a href="http://blog.emson.co.uk">Ben Emson</a></h1> 
            
            <div id="post">
<h1>How to determine whether a column exists on SQLServer</h1>

<p>I run some SQL scripts against Microsoft's SQLServer in a number of environments, test, staging and production.</p>

<p>One of my problems is that these scripts alter the database schema and I only want them to execute if the change hasn't already been made.</p>

<p>One of these changes was to remove a column from the database, so my question is 'how can I ask SQLServer whether a particular column exists'.</p>

<p>Well the SQL query to check if a column exists and execute a query if it does is as follows:</p>

<div class="highlight"><pre><code class="sql"><span class="n">IF</span> <span class="k">EXISTS</span> <span class="p">(</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">COLUMNS</span>
                 <span class="k">WHERE</span> <span class="k">TABLE_NAME</span><span class="o">=</span><span class="s1">&#39;my_table_name&#39;</span> <span class="k">AND</span>
                 <span class="k">COLUMN_NAME</span><span class="o">=</span><span class="s1">&#39;my_column_name&#39;</span> <span class="p">)</span>
<span class="k">BEGIN</span>
  <span class="n">PRINT</span> <span class="s1">&#39;Execute some query here&#39;</span>
<span class="k">END</span>
</code></pre>
</div>




</div>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>24 Jun 2010</span> &raquo; <a href="/2010/06/ruby-quine-example">Ruby Quine Example</a></li>
    
      <li><span>11 May 2010</span> &raquo; <a href="/2010/05/what-is-the-difference-between-a-proc-and-a-lambda-in-ruby">What is the Difference Between a Proc and a Lambda in Ruby?</a></li>
    
      <li><span>09 May 2010</span> &raquo; <a href="/2010/05/code-kata-four-exercise-a-ruby-solution">Code Kata Four Exercise - A Ruby Solution</a></li>
    
  </ul>
</div>
 
            <div class="footer">  
					    <div class="rss">
					      <a href="http://feeds.feedburner.com/ben-emson">
					        <img src="/images/rss.png" alt="Subscribe to RSS Feed" />
					      </a>
					    </div>
                <p>A project by <a href="http://blog.emson.co.uk">Ben Emson</a> | <a href="http://twitter.com/emson">@emson</a>.</p> 
            </div> 
 
        </div> 
				<!-- Google Analytics -->
    </body> 
</html>